<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="include/head">

</head>

<style>
    .aHangye{
        margin:2px 10px;
        float: left;
        background: rgba(123,45,111,0.1);
        border-radius: 10px;
        padding:3px 15px;
    }
</style>
<body>
    <div style="height: 300px;overflow: scroll">
        <div th:each="aHangye:${allHangye}">
            <label th:text="${aHangye}" class="aHangye" th:attr="data-name=${aHangye}"></label>
        </div>
    </div>
    <div>
        <div class="myChartClass" style="width:500px;height:400px;margin:20px auto;" >
            <canvas id="myChart"></canvas>
            <div id="shares"></div>
        </div>
    </div>
</body>

<script>
    $(function () {
        $(".aHangye").click(function () {
            // console.log($(this).data("name"));
            var nowHangye = $(this).data("name");
            console.log("nowHangye = " + nowHangye);
            $.ajax(
                {
                    type: "POST",
                    url: '/shares/showOneConcept',
                    contentType: 'application/json;charset=UTF-8',
                    dataType:"json",
                    data:JSON.stringify({hangye:nowHangye}),
                    success: function(datas){
                        //绘制
                        console.log(datas);
                        var ctx = document.getElementById('myChart').getContext('2d');
                        var oneDayData = datas.everyDaySortData;
                        var labels = new Array();
                        var datas1 = new Array();
                        for(var aDataIndex in datas.everyDaySortData){
                            labels.push(datas.everyDaySortData[aDataIndex].dayIndex);
                            datas1.push(-1 * datas.everyDaySortData[aDataIndex].paihangIndex);
                        }
                        var data = {
                            labels: labels,
                            datasets: [{
                                label: datas.hangye,
                                data: datas1,
                                backgroundColor: [
                                    'rgba(255, 99, 132, 0.2)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)'
                                ],
                                borderWidth: 1
                            }]
                        };
                        var myBarChart = new Chart(ctx, {
                            type: 'line',
                            data: data
                        });

                        $("#shares").text(datas.shareNameList);
                    }
                }
            );
        });
    });
</script>
</html>